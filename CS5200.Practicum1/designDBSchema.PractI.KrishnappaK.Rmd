---
title: "Part B: Design Normalized Database"
author: "Krishnappa, Kushal"
date: "Spring 2025"
output:
  html_document:
    df_print: paged
  pdf_document:
    keep_tex: true
---

<!-- Reference: Used chatGPT to cohesively draft the introduction. -->
## **1. Introduction**

This document presents a **normalized relational database schema** for managing restaurant visits. The schema follows **Third Normal Form (3NF)** to eliminate redundancy and ensure data integrity. The steps involved include listing the initial **functional dependencies** for a restaurant visit relation represented by all of the columns, identifying **entities** and their relationships, performing **decomposition** on identified **entities** and  **functional dependencies** to ensure normalization to 3NF, and designing an **Entity-Relationship Diagram (ERD)** to illustrate the final structure.

## **2. Functional Dependencies Identified For CSV Data**

Initial data for the restaurant visits is a single relation represented by all of the columns. The functional dependencies are identified from the raw data to understand the relationships between the attributes.

$$
\text{VisitID} \rightarrow 
\left\{
\begin{array}{l}
\text{Restaurant}, \text{ServerEmpID}, \text{ServerName}, \text{StartDateHired}, \text{EndDateHired}, \text{HourlyRate}, \\
\text{ServerBirthDate}, \text{ServerTIN}, \text{VisitDate}, \text{VisitTime}, \text{MealType}, \text{PartySize}, \text{Genders}, \\
\text{WaitTime}, \text{CustomerName}, \text{CustomerPhone}, \text{CustomerEmail}, \text{LoyaltyMember}, \\
\text{FoodBill}, \text{TipAmount}, \text{DiscountApplied}, \text{PaymentMethod}, \text{OrderedAlcohol}, \text{AlcoholBill} 
\end{array}
\right\}
$$

$$
\text{ServerEmpID} \rightarrow 
\left\{
\begin{array}{l}
\text{ServerName}, \text{StartDateHired}, \text{EndDateHired}, \text{HourlyRate}, \text{ServerBirthDate}, \text{ServerTIN}
\end{array}
\right\}
$$

$$
\text{CustomerName} \rightarrow \{\text{CustomerPhone}, \text{CustomerEmail}, \text{LoyaltyMember}\}
$$

## **3. Normalization**

### **3.1 Entities Identified and Attributes Grouped**

#### **1. Visit**
  - **key**: `VisitID`
  - `Restaurant`
  - `VisitDate`
  - `VisitTime`
  - `MealType`
  - `PartySize`
  - `Genders`
  - `WaitTime`

#### **2. Server**
  - **key**: `ServerEmpID`
  - `ServerName`
  - `StartDateHired`
  - `EndDateHired`
  - `HourlyRate`
  - `ServerBirthDate`
  - `ServerTIN`
  
#### **3. Customer**
  - **key**: `CustomerID`
  - `CustomerPhone`
  - `CustomerName`
  - `CustomerEmail`
  - `LoyaltyMember`
  
#### **4. Billing**
  - **key**: `BillingID`
  - `FoodBill`
  - `TipAmount`
  - `DiscountApplied`
  - `PaymentMethod`
  - `orderedAlcohol`
  - `AlcoholBill`
  
#### **Relationship Between Identified Entities**

#### 1. Visit - Customer Relationship (One-to-Many)
- **Explanation**: A **customer** can make multiple **visits**, but each **visit** is associated with a single **customer**.
- **Cardinality**: **1 Customer → M Visits** (1:N)

#### 2. Visit - Server Relationship (One-to-Many)
- **Explanation**: A **server** can attend multiple **visits**, but each **visit** is handled by a single **server**.
- **Cardinality**: **1 Server → M Visits** (1:N)

#### 3. Visit - Billing Relationship (One-to-One)
- **Explanation**: Each **visit** has exactly **one** related **billing entry**, and each **billing entry** belongs to exactly **one visit**.
- **Cardinality**: **1 Visit → 1 Billing** (1:1)
  
### **3.2 Approach To Normalization**

- **1NF**: Each attribute is atomic. All the tables have separate columns for ID's which will uniquely identify each row.

- **2NF**: Partial dependencies are eliminated by decomposing the relation into multiple relations and ensuring each relation has a single primary key.

- **3NF**: Transitive dependencies are removed by creating separate relations for the dependent attributes. 

**Functional Dependencies From Normalized Database**

$$
\text{PaymentID} \rightarrow \{\text{PaymentMethod}\}
$$

$$
\text{CustomerID} \rightarrow \{\text{CustomerName}, \text{CustomerPhone}, \text{CustomerEmail}, \text{LoyaltyMember}\}
$$

$$
\text{RestaurantID} \rightarrow \{\text{RestaurantName}\}
$$

$$
\text{MealTypeID} \rightarrow \{\text{MealType}\}
$$

$$
\text{ServerEmpID} \rightarrow 
\left\{
\begin{array}{l}
\text{ServerName}, \text{StartDateHired}, \text{EndDateHired}, \text{HourlyRate}, \text{ServerBirthDate}, \text{ServerTIN}
\end{array}
\right\}
$$

$$
\text{VisitID} \rightarrow 
\left\{
\begin{array}{l}
\text{RestaurantID}, \text{ServerEmpID}, \text{VisitDate}, \text{VisitTime}, \text{MealTypeID}, \text{PartySize}, \text{Genders}, \\
\text{WaitTime}, \text{CustomerID}
\end{array}
\right\}
$$

$$
\text{BillID} \rightarrow 
\left\{
\begin{array}{l}
\text{VisitID}, \text{FoodBill}, \text{TipAmount}, \text{DiscountApplied}, \text{PaymentID}, \text{OrderedAlcohol}, \\
\text{AlcoholBill}
\end{array}
\right\}
$$

## **4. ERD for Normalized Tables**

**Entity-Relationship Diagram (ERD) in Crow's Foot Notation**

```{r erdImageInCrowsFootNatation, warning=FALSE, echo=FALSE, eval=TRUE}
#*****************************************
#* Install Required Packages
#* @param packages - list of packages
#*****************************************
installPackagesOnDemand <- function(packages) {
  # install the required packages if not present
  installed_packages <- packages %in% rownames(installed.packages())
  if (any(installed_packages == FALSE)) {
    install.packages(packages[!installed_packages])
  }
}

#*****************************************
#* Load Required Packages
#* @param packages - list of packages
#*****************************************
loadRequiredPackages <- function(packages) {
  # load required packages
  for (package in packages) {
    suppressMessages({
      library(package, character.only = TRUE)
    })
  }
}

packages <- c("knitr")

img_path <- "ERD.png"

knitr::include_graphics(img_path)
```
